<Window x:Class="Mitarbeiter.Kalender.App.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:controls="clr-namespace:Mitarbeiter.Kalender.App.Controls"
        mc:Ignorable="d"
        Title="Mitarbeiter Kalender"
        Width="1400" Height="800"
        Background="{DynamicResource AppBackground}">

    <Grid Margin="14">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="12"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header / Toolbar (Excel-like) -->
        <Border Grid.Row="0"
                CornerRadius="14"
                Background="{DynamicResource Surface}"
                BorderBrush="{DynamicResource Border}"
                BorderThickness="1"
                Padding="12">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="340"/>
                    <ColumnDefinition Width="340"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Left: Inputs -->
                <StackPanel Grid.Column="0" Spacing="8">
                    <TextBlock Text="Mitarbeitername:" Foreground="{DynamicResource TextMuted}" FontWeight="SemiBold"/>
                    <ComboBox ItemsSource="{Binding Employees}"
                              SelectedItem="{Binding SelectedEmployee}"
                              DisplayMemberPath="DisplayName"
                              Height="34"
                              Style="{DynamicResource ExcelCombo}"/>

                    <TextBlock Text="Kundenname:" Foreground="{DynamicResource TextMuted}" FontWeight="SemiBold" Margin="0,6,0,0"/>
                    <TextBox Text="{Binding CustomerFilter, UpdateSourceTrigger=PropertyChanged}"
                             Height="34"
                             Style="{DynamicResource ExcelTextBox}"/>
                </StackPanel>

                <!-- Middle: Month navigation -->
                <StackPanel Grid.Column="1" Spacing="10" Margin="16,0,0,0">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Spacing="10">
                        <TextBlock Text="Jahr:" Foreground="{DynamicResource TextMuted}" FontWeight="SemiBold" VerticalAlignment="Center"/>
                        <TextBox Text="{Binding Year}" Width="90" Height="34" Style="{DynamicResource ExcelTextBox}"/>

                        <TextBlock Text="Monat:" Foreground="{DynamicResource TextMuted}" FontWeight="SemiBold" Margin="12,0,0,0" VerticalAlignment="Center"/>
                        <TextBox Text="{Binding Month}" Width="70" Height="34" Style="{DynamicResource ExcelTextBox}"/>

                        <Button Content="◀"
                                Command="{Binding PrevMonthCommand}"
                                Width="46" Height="34"
                                Style="{DynamicResource ExcelButtonGrey}"/>
                        <Button Content="▶"
                                Command="{Binding NextMonthCommand}"
                                Width="46" Height="34"
                                Style="{DynamicResource ExcelButtonGrey}"/>
                        <Button Content="Heute"
                                Command="{Binding TodayCommand}"
                                Height="34"
                                Style="{DynamicResource ExcelButtonGrey}"/>
                    </StackPanel>

                    <!-- Excel-like action buttons row -->
                    <WrapPanel ItemHeight="40" ItemWidth="170" HorizontalAlignment="Left">
                        <Button Content="Termin verteilen" Command="{Binding AddAppointmentCommand}" Style="{DynamicResource ExcelButtonGreen}" Margin="0,0,10,10"/>
                        <Button Content="Serie erstellen" Command="{Binding DemoCommand}" Style="{DynamicResource ExcelButtonPurple}" Margin="0,0,10,10"/>
                        <Button Content="Termin ändern" Command="{Binding EditCommand}" Style="{DynamicResource ExcelButtonOrange}" Margin="0,0,10,10"/>
                        <Button Content="Termin löschen" Command="{Binding DeleteCommand}" Style="{DynamicResource ExcelButtonRed}" Margin="0,0,10,10"/>
                        <Button Content="SYNC" Command="{Binding SyncCommand}" Style="{DynamicResource ExcelButtonBlack}" Margin="0,0,10,10"/>
                        <Button Content="Abwesenheit" Command="{Binding AddAbsenceCommand}" Style="{DynamicResource ExcelButtonYellow}" Margin="0,0,10,10"/>
                        <Button Content="Status ändern" Command="{Binding StatusCommand}" Style="{DynamicResource ExcelButtonPink}" Margin="0,0,10,10"/>
                        <Button Content="MA anlegen" Command="{Binding AddEmployeeCommand}" Style="{DynamicResource ExcelButtonBlue}" Margin="0,0,10,10"/>
                        <Button Content="MA löschen" Command="{Binding RemoveEmployeeCommand}" Style="{DynamicResource ExcelButtonRed}" Margin="0,0,10,10"/>
                    </WrapPanel>
                </StackPanel>

                <!-- Right: small hint -->
                <StackPanel Grid.Column="2" HorizontalAlignment="Right" VerticalAlignment="Top">
                    <TextBlock Text="{Binding MonthTitle}"
                               FontSize="18"
                               FontWeight="SemiBold"
                               Foreground="{DynamicResource Text}"/>
                    <TextBlock Text="Monat horizontal scrollen · Mitarbeiter untereinander"
                               Foreground="{DynamicResource TextMuted}"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Calendar -->
        <controls:ScheduleMonthControl Grid.Row="2"
                                       MonthView="{Binding MonthView}"/>
    </Grid>
</Window>
